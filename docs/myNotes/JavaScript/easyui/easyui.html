<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">

<link rel="stylesheet" type="text/css" href="easyui/themes/default/easyui.css">
<link rel="stylesheet" type="text/css" href="easyui/themes/icon.css">
<script type="text/javascript" src="easyui/jquery.min.js"></script>
<script type="text/javascript" src="easyui/jquery.easyui.min.js"></script>

</head>

<body>
	<div id="p" class="easyui-panel" style="width:500px;height:200px";padding="10px;" title="My Panel" data-options="iconCls:'icon-save',collapsible:true">
		The panel content
	</div>

	<input class="easyui-combobox" name="language"
    		data-options="
    			url:'combobox_data.json',
    			valueField:'id',
			    textField:'text',
			    panelHeight:'auto',
			    onSelect:function(record){
				    alert(record.text);
			    }">


	<table class="easyui-datagrid" data-options="fitColumns:true, singleSelect:true">
    		<thead>
    			<tr>
				<th data-options="field:'code'">Coder</th>
    				<th data-options="field:'name'">Name</th>
    				<th data-options="field:'price'">Price</th>
    			</tr>
    		</thead>
    		<tbody>
    			<tr>
    				<td>001</td><td>name1</td><td>2323</td>
    			</tr>
    			<tr>
    				<td>002</td><td>name2</td><td>4612</td>
    			</tr>
			<tr>
				<td>003></td><td>name3</td><td>2587</td>
			</tr>
    		</tbody>
    	</table>


	<table id="dg"></table>

	<script type="text/javascript">
		$('#dg').datagrid({
			url:'combo.json',
			onClickCell: onClickCell,
			columns:[[
				{field:'code', title:'Code', width:100, editor:{type:'combobox',options:{valueField:'code',textField:'price', url:'prodotti.json'}}},
				{field:'name', title:'Name', width:200},
				{field:'price', title:'Price', width:300}
				]]
			});



	var editIndex = undefined;
	function endEditing(){
		if (editIndex == undefined){return true}
		
		if ($('#dg').datagrid('validateRow', editIndex)){
			var ed = $('#dg').datagrid('getEditor', {index:editIndex,field:'productid'});
			var productname = $(ed.target).combobox('getText');
			$('#dg').datagrid('getRows')[editIndex]['productname'] = productname;
			$('#dg').datagrid('endEdit', editIndex);
			editIndex = undefined;
			return true;
		} else {
			return false;
		}
	}




	function onClickCell(index, field){
		if (editIndex != index){
			if (endEditing()){
				$('#dg').datagrid('selectRow', index).datagrid('beginEdit', index);
				var ed = $('#dg').datagrid('getEditor', {index:index,field:field});
				($(ed.target).data('textbox') ? $(ed.target).textbox('textbox') : $(ed.target)).focus();
				editIndex = index;
			} else {
				$('#dg').datagrid('selectRow', editIndex);
			}
		}
	}
				 
	</script>














</body>

</html>
